# configs/config.yaml
log_file: /var/log/hids/security.log
log_format: json
workers: 8  # 2x cores CPU recommandé

performance:
  stat_cache_ttl: 10
  user_cache_ttl: 600
  max_event_queue_size: 50000

watched_paths:
  # === SYSTÈME CRITIQUE ===
  - path: /etc/passwd
    recursive: false
    events: [open, write]
    min_uid: 0

  - path: /etc/shadow
    recursive: false
    events: [open, read, write]
    min_uid: 0

  - path: /etc/sudoers
    recursive: false
    events: [open, write]
    min_uid: 0

  - path: /etc/ssh
    recursive: true
    events: [write]
    min_uid: 0

  # === BINAIRES ===
  - path: /usr/bin
    recursive: false
    events: [write, exec]
    min_uid: 0

  - path: /usr/sbin
    recursive: false
    events: [write, exec]
    min_uid: 0

  - path: /bin
    recursive: false
    events: [write]
    min_uid: 0

  - path: /sbin
    recursive: false
    events: [write]
    min_uid: 0

  # === UTILISATEURS ===
  - path: /home
    recursive: true
    events: [write, exec]
    min_uid: 1000

  - path: /root
    recursive: true
    events: [write, exec]
    min_uid: 0

  # === WEB ===
  - path: /var/www
    recursive: true
    events: [write, exec]
    allowed_gids: [33, 1000]

  # === LOGS ===
  - path: /var/log
    recursive: true
    events: [write, delete]
    min_uid: 0

  # === CRON ===
  - path: /etc/cron.d
    recursive: true
    events: [write]
    min_uid: 0

  - path: /var/spool/cron
    recursive: true
    events: [write]
    min_uid: 0

whitelist:
  users:
    - uid: 0
      username: root
      allowed_ops: [read, write, exec]

    - uid: 1000
      username: admin
      allowed_ops: [read, write]
      exceptions:
        - pattern: /home/admin/*
          operations: [read, write, exec]
          is_regex: false

        - pattern: ^/tmp/admin-.*\.tmp$
          operations: [write]
          is_regex: true

    - uid: 33
      username: www-data
      allowed_ops: [read]
      exceptions:
        - pattern: /var/www/html/uploads/*
          operations: [read, write]
          is_regex: false

blacklist:
  uids: [65534, 65533, 65535]
